<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>üéö –ó–≤—É–∫–æ–≤–æ–π –ü—É–ª—å—Ç –†–µ–∂–∏—Å—Å—ë—Ä–∞</title>
    <style>
        body { font-family: sans-serif; background: #111; color: #fff; padding: 20px; }
        h2 { color: #ffd700; }
        .category { margin-bottom: 30px; }
        .button-grid { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px; }
        button {
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            background: #444;
            color: white;
            cursor: pointer;
        }
        button:hover {
            background: #00aaff;
        }
    </style>
</head>
<body>
<h1>üé¨ –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–≤—É–∫–∞–º–∏</h1>
<div id="soundPanel">–ó–∞–≥—Ä—É–∑–∫–∞...</div>

<button onclick="stopSound()">üõë –°—Ç–æ–ø</button>

<script>
    async function loadSounds() {
        const res = await fetch('/sound/categories');
        const data = await res.json();
        const panel = document.getElementById('soundPanel');
        panel.innerHTML = '';

        Object.keys(data).forEach(category => {
            const section = document.createElement('div');
            section.className = 'category';

            const title = document.createElement('h2');
            title.textContent = category;
            section.appendChild(title);

            const grid = document.createElement('div');
            grid.className = 'button-grid';

            data[category].forEach(filename => {
                const btn = document.createElement('button');
                btn.textContent = filename;
                btn.onclick = () => playSound(filename);
                grid.appendChild(btn);
            });

            section.appendChild(grid);
            panel.appendChild(section);
        });
    }

    async function playSound(filename) {
        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä—É (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏)
        await fetch('/sound/play?filename=' + encodeURIComponent(filename), {
            method: 'POST'
        });

        // –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
        const audio = new Audio('/sounds/' + filename);
        try {
            await audio.play();
        } catch (err) {
            console.error("üéß –û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è:", err);
            alert("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –∑–≤—É–∫. –ë—Ä–∞—É–∑–µ—Ä, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, —Ç—Ä–µ–±—É–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.");
        }
    }

    async function stopSound() {
        await fetch('/sound/stop', { method: 'POST' });
        alert("‚èπ –ó–≤—É–∫ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω");
    }

    loadSounds();
</script>

</body>
</html>
